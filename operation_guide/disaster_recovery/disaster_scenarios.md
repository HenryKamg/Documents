# 灾难场景

```
* 场景N： * * *

* 故障等级：

* 现象描述：

* 故障原因：
1）
2）
3）
。。。
N）

* 恢复方案：
1）排查方法
2）解决方法

* 预计故障恢复时间
排查&解决问题所用的总时间
```

##### 场景 No.1：某个租户所有虚拟机无法连接外网

* 故障等级：

* 现象描述：

  * 登录某个租户的任意一台虚拟机，ping公网任意一个IP地址，不通。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.2：虚拟机无法通过DHCP方式获取IP地址

* 故障等级：

* 现象描述：

  * 登录虚拟机，查看IP地址等网络信息，处于未配置状态。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.3：所有租户的所有虚拟机无法连接外网

* 故障等级：

* 现象描述：

  * 登录所有租户的任意一台虚拟机，ping公网任意一个IP地址，不通。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.4：同一租户下两台虚拟机网络流量很高，导致所有租户的网络受到影响

* 故障等级：

* 现象描述：

  * 登录任意一台虚拟机，ping其它节点或外网延迟非常大，丢包率非常高。

* 故障原因：

  * 环境中某一台或多台虚拟机向外发送大量数据包，占用了大量网络带宽。

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.5：虚拟机限速时，在该虚拟机向外发包，其它租户的虚拟机的网络受到影响

* 故障等级：

* 现象描述：

  * 登录任意一台虚拟机，ping其它节点或外网延迟非常大，丢包率非常高。

* 故障原因：

  * 环境中某一台或多台被限速的虚拟机向外发送大量的数据包，占用了大量带宽。

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.6：一台 Controller 节点宕机

* 故障等级：

* 现象描述：

  * 环境中任意一台 Controller 节点宕机

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.7：N/2台 Controller 节点宕机（N为Controller节点总数）

* 故障等级：

* 现象描述：

  * MySQL 集群故障
  * RabbitMQ 集群故障

* 故障原因：

  * 环境中 N/2 台 Controller 节点宕机（N为Controller节点总数）

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.8：所有 Controller 节点宕机（是否与N/2虚拟机宕机合并？）

* 故障等级：

* 现象描述：

  * 访问DashBoard报404错误

* 故障原因：

  * 环境中所有 Controller 节点宕机

* 恢复方案：

  * 排查方法
    
    * 检查在线 Controller 节点数量是否为0
    
  * 解决方法

    * 保证在线 Controller 节点数量大于0

* 预计故障恢复时间

===

##### 场景 No.9：Compute 节点宕机，集群中可用资源可满足该节点上的虚拟机迁移到其它节点

* 故障等级：

* 现象描述：

  * Compute 节点宕机，运行在该节点上的虚拟机宕机，环境中可用资源满足宕掉的虚拟机的迁移需求

* 故障原因：

  * Compute 节点宕机

* 恢复方案：

  * 排查方法
    
    * 确认 Compute 节点宕机前，运行在该节点上的虚拟机列表
    * 确认环境中可用资源可以满足宕掉的虚拟机的迁移需求
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.10：Compute 节点宕机，集群中可用资源不能满足该节点上的虚拟机迁移到其它节点

* 故障等级：

* 现象描述：

  * Compute 节点宕机，运行在该节点上的虚拟机宕机，环境中可用资源无法满足重新启动宕掉的虚拟机

* 故障原因：

  * Compute 节点宕机

* 恢复方案：

  * 排查方法
    
    * 确认 Compute 节点宕机前，运行在该节点上的虚拟机列表
    * 确认环境中可用资源无法满足重新启动宕掉的虚拟机
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.11：小于三台 Ceph-osd 节点宕机（是否有必要设置该场景？）

* 故障等级：

* 现象描述：

  * 是否有外在现象？

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### No.12：大于或等于三台 Ceph-osd 节点宕机

* 故障等级：

* 现象描述：

  * 外在现象是什么？

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.13：Mongo 节点宕机

* 故障等级：

* 现象描述：

  * Ceilometer 服务不可用，报数据库连接错误。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.14：Fuel 节点宕机

* 故障等级：

* 现象描述：

  * 所有 OpenStack 节点NTP同步失败。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.15：MySQL 集群故障

* 故障等级：

* 现象描述：

  * 任意 OpenStack 组件连接数据库失败，日志中报数据库连接错误。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.16：RabbitMQ 集群故障

* 故障等级：

* 现象描述：

  * 任意 OpenStack 组件连接 RabbitMQ 失败，日志中报 rabbitmq 连接错误。

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

===

##### 场景 No.17：Ceph 集群故障，数据未丢失

* 故障等级：

* 现象描述：

  * Ceph 集群故障，数据未丢失

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间

##### 场景 No.18：Ceph 集群故障，数据丢失

* 故障等级：

* 现象描述：

  * Ceph 集群故障，数据丢失

* 故障原因：

  * 

* 恢复方案：

  * 排查方法
    
    * 
    
  * 解决方法

    * 

* 预计故障恢复时间


