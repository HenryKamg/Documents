# FWaaS和iptables规则之间的对应关系
FWaaS本身是基于linux的iptables而来的，所以FWaaS和iptables本身就有一个对应关系，可以通过命令行查看得到

1.
确认防火墙所的路由在哪个节点上，可以在每个network节点上执行一次命令：
```
ip netns | grep 路由-ID
```

查看路由-ID，执行命令：
```
neutron router-show 路由-NAME
```


2.
使用返回的namespace名字，操作namespace。操作namespace的命令为：
```
ip netns exec namespace-id command
```

例如：
```
ip netns exec qrouter-id iptables-save -t filter
```
通过这条命令可以查看到对应的iptables规则

3.
在具体的查看iptables的规则，使用如下的例子说明
```
ip netns exec qrouter-32dafff3-0d36-497c-8c99-c2c170d4419c iptables-save -t filter
# Generated by iptables-save v1.4.21 on Tue May 26 13:51:22 2015
*filter
:INPUT ACCEPT [32:2032]
:FORWARD ACCEPT [0:0]
:OUTPUT ACCEPT [0:0]
:neutron-filter-top - [0:0]
:neutron-l3-agent-FORWARD - [0:0]
:neutron-l3-agent-INPUT - [0:0]
:neutron-l3-agent-OUTPUT - [0:0]
:neutron-l3-agent-fwaas-defau - [0:0]
:neutron-l3-agent-iv44acbd26b - [0:0]
:neutron-l3-agent-local - [0:0]
:neutron-l3-agent-ov44acbd26b - [0:0]
-A INPUT -j neutron-l3-agent-INPUT
-A FORWARD -j neutron-filter-top
-A FORWARD -j neutron-l3-agent-FORWARD
-A OUTPUT -j neutron-filter-top
-A OUTPUT -j neutron-l3-agent-OUTPUT
-A neutron-filter-top -j neutron-l3-agent-local
-A neutron-l3-agent-FORWARD -o qr-+ -j neutron-l3-agent-iv44acbd26b
-A neutron-l3-agent-FORWARD -i qr-+ -j neutron-l3-agent-ov44acbd26b
-A neutron-l3-agent-FORWARD -o qr-+ -j neutron-l3-agent-fwaas-defau
-A neutron-l3-agent-FORWARD -i qr-+ -j neutron-l3-agent-fwaas-defau
-A neutron-l3-agent-INPUT -d 127.0.0.1/32 -p tcp -m tcp --dport 8775 -j ACCEPT
-A neutron-l3-agent-fwaas-defau -j DROP
-A neutron-l3-agent-iv44acbd26b -m state --state INVALID -j DROP
-A neutron-l3-agent-iv44acbd26b -m state --state RELATED,ESTABLISHED -j ACCEPT
-A neutron-l3-agent-iv44acbd26b -p tcp -m tcp --dport 80 -j ACCEPT
-A neutron-l3-agent-ov44acbd26b -m state --state INVALID -j DROP
-A neutron-l3-agent-ov44acbd26b -m state --state RELATED,ESTABLISHED -j ACCEPT
-A neutron-l3-agent-ov44acbd26b -p tcp -m tcp --dport 80 -j ACCEPT
COMMIT
# Completed on Tue May 26 13:51:22 2015

```

例子说明：

a.`-A neutron-l3-agent-FORWARD -o qr-+ -j neutron-l3-agent-iv44acbd26b`
表示的含义是：如果输出端口为qr-，则会跳转到`neutron-l3-agent-iv44acbd26b`继续处理

b.`-A neutron-l3-agent-FORWARD -i qr-+ -j neutron-l3-agent-ov44acbd26b`表示的含义就是如果输入端口是qr-，则会跳转到`neutron-l3-agent-ov44acbd26b`进行输出处理。

c.`-A neutron-l3-agent-iv44acbd26b -p tcp -m tcp --dport 80 -j ACCEPT`就是对应的firewall规则，在`neutron-l3-agent-iv44acbd26b`上进行处理，协议为tcp，匹配的协议为tcp，目的端口是80，模式为允许。就和我们开始的firewall里面的规则是一样的。






