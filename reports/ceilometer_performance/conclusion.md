# 测试结论

## 对比分析

通过前面章节的测试结果中，分析如下：

* EayunStack 1.0.1 和 EayunStack 1.1 中的 Ceilometer 性能变化：

  1. Ceilometer 升级至 1.1 版本后，在高并发和大量的请求下，运行正常，没有出现失败的情况；
  1. 在相同的请求数和并发数下，1.1 版本的 Ceilometer 对数据库的压力减小，数据库的 CPU 使用率减少一半已上；
  1. Ceilometer 升级至 1.1 版本后，每秒查询次数有所下降；
  1. Ceilometer 升级至 1.1 版本后，请求的实际时间有所增加，但用户 CPU 时间和系统 CPU 时间基本没有变化。
  1. 升级后的 Ceilometer 能承受更高的并发数和请求数。

* Mongo 数据库优化后的性能变化：

  1. Mongo 数据库和 API 优化后，数据库的 CPU 使用率下降了几十倍，CPU 使用率维持在 50% 以内；
  1. 在相同的请求数和并发数下，Mongo 数据库和 API 优化后，每秒查询次数增加了几十倍；
  1. Mongo 数据快和 API 优化后，请求的实际时间大大缩短，即使在大量请求和高并发请求下，也没有超过 1 分钟（请求和并发特别大的已超过），用户 CPU 时间和系统 CPU 时间有所缩短，但变化不大。

## 测试结论

通过以上分析，对 Ceilometer 的性能优化得到以下结论：

1. Ceilometer 升级至 1.1 版本后，对数据库的压力大大减小，能够承受更高的并发数和请求数；
1. Ceilometer 升级至 1.1 版本后，虽然每秒的查询次数有所下将，请求的实际时间有所增加，但获得的性能优化利大于弊；
1. Mongo 数据库和 API 优化后，大大减轻了数据库的压力，CPU 使用率和请求的实际时间大幅度下降，提高了性能；
1. Mongo 数据库和 API 优化后，每秒查询次数的大幅度增加带来了性能的提高，进而增加了平台的稳定性；

**因此，将 Ceilometer 升级至 EayunStack 1.1 版本，并且将对数据库和 API 的优化一同升级，可以解决 Ceilometer 的瓶颈问题，性能大幅度提高。**
