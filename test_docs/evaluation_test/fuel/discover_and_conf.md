# 发现和配置节点

## 发现节点

### 发现 Controller 节点

* 前提：

  对环境做好规划，准备好作为 Controller 节点的机器。

* 操作：

  1. 启动环境中所规划的所有 Controller 节点；
  1. 进入 Controller 节点的 BIOS 界面，设置引导顺序中第一项为网卡启动；
  1. 启动服务器；
  1. 等待所有 Controller 节点启动完成后，在 Fuel 管理界面的右上角中收到发现新节点的消息提示；
  1. 点击 Fuel 管理界面上的【节点】标签，切换到节点界面，点击【增加节点】按钮；
  1. 跳转到【分配角色】界面，勾选 【Controller】 选项，勾选页面下方所发现的所有 Controller 节点的【选择全部】，点击【应用变更】按钮。

* 预期结果：

  * 成功发现所有 Controller 节点；
  * 添加 Controller 节点成功；
  * 所添加的节点将作为 Controller 节点部署到 OpenStack 环境中。

### 发现 Compute 节点

* 前提：

  对环境做好规划，准备好作为 Compute 节点的机器。

* 操作：

  1. 启动环境中所规划的所有 Compute 节点；
  1. 进入 Compute 节点的 BIOS 界面，设置引导顺序中第一项为网卡启动；
  1. 启动服务器；
  1. 等待所有 Compute 节点启动完成后，在 Fuel 管理界面的右上角中收到发现新节点的消息提示；
  1. 点击 Fuel 管理界面上的【节点】标签，切换到节点界面，点击【增加节点】按钮；
  1. 跳转到【分配角色】界面，勾选 【Compute】 选项，勾选页面下方所发现的所有 Compute 节点的【选择全部】，点击【应用变更】按钮。

* 预期结果：

  * 成功发现所有 Compute 节点；
  * 添加 Compute 节点成功；
  * 所添加的节点将作为 Compute 节点部署到 OpenStack 环境中。


### 发现 Mongo 节点

* 前提：

  对环境做好规划，准备好作为 Mongo 节点的机器。

* 操作：

  1. 启动环境中所规划的所有 Mongo 节点；
  1. 进入 Mongo 节点的 BIOS 界面，设置引导顺序中第一项为网卡启动；
  1. 启动服务器；
  1. 等待所有 Mongo 节点启动完成后，在 Fuel 管理界面的右上角中收到发现新节点的消息提示；
  1. 点击 Fuel 管理界面上的【节点】标签，切换到节点界面，点击【增加节点】按钮；
  1. 跳转到【分配角色】界面，勾选 【Telemetry-MongoDB】 选项，勾选页面下方所发现的所有 Mongo 节点的【选择全部】，点击【应用变更】按钮。

* 预期结果：

  * 成功发现所有 Mongo 节点；
  * 添加 Mongo 节点成功；
  * 所添加的节点将作为 Mongo 节点部署到 OpenStack 环境中。

### 发现 Ceph-osd 节点

* 前提：

  对环境做好规划，准备好作为 Ceph-osd 节点的机器。

* 操作：

  1. 启动环境中所规划的所有 Ceph-osd 节点；
  1. 进入 Ceph-osd 节点的 BIOS 界面，设置引导顺序中第一项为网卡启动；
  1. 启动服务器；
  1. 等待所有 Ceph-osd 节点启动完成后，在 Fuel 管理界面的右上角中收到发现新节点的消息提示；
  1. 点击 Fuel 管理界面上的【节点】标签，切换到节点界面，点击【增加节点】按钮；
  1. 跳转到【分配角色】界面，勾选 【Storage-Ceph OSD】 选项，勾选页面下方所发现的所有 Ceph-osd 节点的【选择全部】，点击【应用变更】按钮。

* 预期结果：

  * 成功发现所有 Ceph-osd 节点；
  * 添加 Ceph-osd 节点成功；
  * 所添加的节点将作为 Ceph-osd 节点部署到 OpenStack 环境中。

### 完成发现

* 前提：

  * 对环境所有规划的节点发现成功；
  * 登录到 Fuel 管理界面。

* 操作：

  1. 进入所配置的 OpenStack 环境；
  1. 点击【节点】标签。

* 预期结果：

  * 列出环境中所发现的所有节点；
  * 所有节点的角色已分配。

## 配置节点

### 配置 Controller 节点

#### 配置磁盘

* 前提：

  * 已经发现 Controller 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Controller 节点后勾选【选择全部】，以选择所有的 Controller 节点；
  1. 点击【磁盘配置】按钮；
  1. 在磁盘配置窗口中，配置 Controller 节点的磁盘分区；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Controller 节点的磁盘分区。

#### 配置网络

* 前提：

  * 已经发现 Controller 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Controller 节点后勾选【选择全部】，以选择所有的 Controller 节点；
  1. 点击【网络配置】按钮；
  1. 在网络配置窗口中，拖动 "Admin(PXE)"、"管理"、"公开"、"存储"、"Private" 标签，将各个网络对应 Controller 节点所规划的网卡进行配置；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Controller 节点的网络。

### 配置 Compute 节点

#### 配置磁盘

* 前提：

  * 已经发现 Compute 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Compute 节点后勾选【选择全部】，以选择所有的 Compute 节点；
  1. 点击【磁盘配置】按钮；
  1. 在磁盘配置窗口中，配置 Compute 节点的磁盘分区；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Compute 节点的磁盘分区。

#### 配置网络

* 前提：

  * 已经发现 Compute 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Compute 节点后勾选【选择全部】，以选择所有的 Compute 节点；
  1. 点击【网络配置】按钮；
  1. 在网络配置窗口中，拖动 "Admin(PXE)"、"管理"、"公开"、"存储"、"Private" 标签，将各个网络对应 Compute 节点所规划的网卡进行配置；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Compute 节点的网络。
  
### 配置 Mongo 节点

#### 配置磁盘

* 前提：

  * 已经发现 Mongo 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Mongo 节点后勾选【选择全部】，以选择所有的 Mongo 节点；
  1. 点击【磁盘配置】按钮；
  1. 在磁盘配置窗口中，配置 Mongo 节点的磁盘分区；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Mongo 节点的磁盘分区。

#### 配置网络

* 前提：

  * 已经发现 Mongo 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Mongo 节点后勾选【选择全部】，以选择所有的 Mongo 节点；
  1. 点击【网络配置】按钮；
  1. 在网络配置窗口中，拖动 "Admin(PXE)"、"管理"、"公开"、"存储"、"Private" 标签，将各个网络对应 Mongo 节点所规划的网卡进行配置；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Mongo 节点的网络。

### 配置 Ceph-osd 节点

#### 配置磁盘

* 前提：

  * 已经发现 Ceph-osd 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Ceph-osd 节点后勾选【选择全部】，以选择所有的 Ceph-osd 节点；
  1. 点击【磁盘配置】按钮；
  1. 在磁盘配置窗口中，配置 Ceph-osd 节点的磁盘分区；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Ceph-osd 节点的磁盘分区。

#### 配置网络

* 前提：

  * 已经发现 Ceph-osd 节点；
  * 登录到 Fuel 管理界面中。

* 操作：

  1. 点击【节点】标签，在节点列表中，在 Ceph-osd 节点后勾选【选择全部】，以选择所有的 Ceph-osd 节点；
  1. 点击【网络配置】按钮；
  1. 在网络配置窗口中，拖动 "Admin(PXE)"、"管理"、"公开"、"存储"、"Private" 标签，将各个网络对应 Ceph-osd 节点所规划的网卡进行配置；
  1. 配置完成后，点击【应用】按钮。

* 预期结果：

  成功配置 Ceph-osd 节点的网络。
