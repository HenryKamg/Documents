# 验证组件的 Token

|类型编号|类型名称|模块编号|模块名称|
|--------|--------|--------|--------|
|01|功能测试|01|验证 Token|

|内容编号|内容名称|
|--------|--------|
|01|authenticate|


|测试编号|测试目的|操作|预期结果|实际结果|备注|Rally/Tempest/None|
|:--------|:--------|:----|:--------|:--------|:----|:------------------|
|01010101|验证 keystone 客户端|<ul><li>CURL:</li></ul><ol><li>登录到openstack认服务环境中；</li><li>使用curl命令获取令牌ID，执行命令``` curl -s -X POST http://192.168.3.131:5000/v2.0/tokens -H "Content-Type: application/json" -d '{"auth": {"tenantName": "", "passwordCredentials": {"username": "'"$OS_USERNAME"'", "password": "'"$OS_PASSWORD"'"}}}'| python -m json.tool```；</li><li>获取到令牌ID后使用计算服务API列出虚拟机；</li><li>执行命令:```curl -s -H "X-Auth-Token:令牌ID" http://192.168.3.131:8774/v2/租户ID/servers | python -m json.tool```。</li></ol><ul><li>CLI:</li></ul><ol><li>登录rally测试服务器；</li><li>使用rally测试文档keystone.json；</li><li>执行测试命名```rally task start keystone.json```。|</li><li>CURL:返回HTTP状态码，验证成功。</li><li>CLI:rally测试成功。|||Rally:</br>keystone.json|
|01010102|验证 cinder 客户端的 token|<ul><li>CURL:</li></ul><ol><li>登录到openstack的认证服务的环境中；</li><li>使用curl命令获取令牌，执行命令 ```curl -s -X POST http://192.168.3.131:5000/v2.0/tokens -H "Content-Type: application/json" -d '{"auth": {"tenantName": "", "passwordCredentials": {"username": "'"$OS_USERNAME"'", "password": "'"$OS_PASSWORD"'"}}}' | python -m json.tool```；</li><li>通过命令就可获取到令牌ID；</li><li>使用计算服务的API列出正在运行的实例；</li><li>执行命令:```curl -s -H "X-Auth-Token:令牌ID" http://192.168.3.131:8774/v2/租户ID/servers | python -m json.tool```。</li></ol><ul><li>CLI:</li></ul><ol><li>登录rally测试服务器；</li><li>使用rally测试文档token_validate_cinder.json；</li><li>执行测试命令```rally task start token_validate_cinder.json```。|</li><li>CURL:返回HTTP状态码，验证成功</li><li>CLI:rally测试成功||在获取令牌的时候，不知道租户名或者ID的时候可以发送空出去(测试的时候发现令牌ID为乱码)|Rally:</br>token_validate_cinder.json|
|01010103|验证 glance 客户端的 token|<ul><li>CURL:</li></ul><ol><li>登录到openstack的认证服务的环境中；</li><li>使用curl命令获取令牌，执行命令``` curl -s -X POST http://192.168.3.131:5000/v2.0/tokens -H "Content-Type: application/json" -d '{"auth": {"tenantName": "", "passwordCredentials": {"username": "'"$OS_USERNAME"'", "password": "'"$OS_PASSWORD"'"}}}' | python -m json.tool```；</li><li>通过命令就可获取到令牌ID；</li><li>使用计算服务的API列出镜像；</li><li>执行命令```curl -s -H "X-Auth-Token:令牌ID" http://192.168.3.131:8774/v2/租户 id/images | python -m json.tool```。</li></ol><ul><li>CLI:</li></ul><ol><li>登录rally测试服务器；</li><li>使用rally测试文档token_validate_glance.json；</li><li>执行测试命令```rally task start token_validate_glance.json```。|</li><li>CURL:返回HTTP状态码，即验证成功。</li><li>CLI:rally测试成功。|||Rally:</br>token_validate_glance.json|
|01010104|验证 heat 客户端的 token|||||Rally:</br>token_validate_heat.json|
|01010105|验证 neutron 客户端的 token|<ul><li>UI:</li></ul><ol><li>登录到openstack的认证服务的环境中；</li><li>使用curl命令获取令牌，执行命令 ```curl -s -X POST http://192.168.3.131:5000/v2.0/tokens -H "Content-Type: application/json" -d '{"auth": {"tenantName": "", "passwordCredentials": {"username": "'"$OS_USERNAME"'", "password": "'"$OS_PASSWORD"'"}}}' | python -m json.tool```；</li><li>通过命令就可获取到令牌ID；</li><li>通过neutron调用网络连接；</li><li>查看网络连接，执行命令:```curl -s -H "X-Auth-Token:令牌ID"http://192.168.3.131:8774/v2/租户ID/net-list | python -m json.tool```。</li></ol><ul><li>CLI:</li></ul><ol><li>登录到rally测试服务器；</li><li>使用rally测试文档token_validate_neutron.json；</li><li>执行测命令:```rally task start token_validate_neutron.json```。|</li><li>CURL:返回HTTP状态码，即验证成功。</li><li>CLI:rally测试成功。|||Rally:</br>token_validate_neutron.json|
|01010106|验证 nova 客户端的 token|<ul><li>CURL:</li></ul><ol><li>登录到openstack的认证服务的环境中；</li><li>使用curl命令获取令牌，执行命令 ```curl -s -X POST http://192.168.3.131:5000/v2.0/tokens -H "Content-Type: application/json" -d '{"auth": {"tenantName": "", "passwordCredentials": {"username": "'"$OS_USERNAME"'", "password": "'"$OS_PASSWORD"'"}}}' | python -m json.tool```；</li><li>通过命令就可获取到令牌ID；</li><li>通过nova调用相关的计算服务；</li><li>列出所有镜像，执行命令:```curl -s -H "X-Auth-Token:令牌ID" http://192.168.3.131:8774/v2/租户 id/images | python -m json.tool```；</li><li>列出云主机类型:```curl -s -H "X-Auth-Token:令牌ID" http://8.21.28.222:8774/v2/租户 id/flavors |  python -m json.tool```。</li><li></li></ol><ul><li>CLI:</li></ul><ol><li>登录rally测试服务器；</li><li>使用rally测试文档token_validate_nova.json；</li><li>执行测试命令```rally task start token_validate_nova.json```。|</li><li>CURL:能够成功的启动实例，nova list和nova show都能够成功的查看到。</li><li>CLI:rally测试成功。|||Rally:</br>token_validate_nova.json|

